<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pag.client.member.dao.MemberDao">

	<!-- 회원정보 조회 -->
	<select id="memberSelect" parameterType="member" resultType="member">
		select m_id, m_name, m_birth, m_gender, m_email, m_phone, m_pw, m_availabled
		from member_tbl 
		where 
			<if test="m_Id != null and m_Id != ''" >
				m_id = #{m_Id}				
			</if>
			<if test="m_Email != null and m_Email != ''" >
				m_email = #{m_Email}				
			</if>		
	</select> 
	
	<!-- 비밀번호확인 -->
	<select id="memberPwSelect" parameterType="string" resultType="string">
		select m_pw 
		from member_tbl 
		where m_id = #{m_Id}				
	</select>
	
	<!-- 회원 가입 -->
	<insert id="memberInsert" parameterType="member">
		<selectKey keyProperty="m_Number" resultType="int" order="BEFORE">
			select member_tbl_seq.nextval from dual
		</selectKey>
		insert into member_tbl(m_id, m_pw, m_number, m_name, m_birth, m_gender, m_email, m_email_marketing, m_phone)
		values(#{m_Id}, #{m_Pw}, #{m_Number}, #{m_Name}, #{m_Birth}, #{m_Gender}, #{m_Email}, #{m_Email_Marketing}, #{m_Phone})
	</insert>
	
	<!-- 회원 정보 수정 -->
	<update id="memberUpdate" parameterType="member">
		update member_tbl set
			<if test="m_Pw != null and m_Pw != ''" >
				m_pw = #{m_Pw}				
			</if>
			<if test="m_Phone != null and m_Phone != ''">
				<if test="m_Pw != null and m_Pw != ''">
					, 
				</if>
				m_phone = #{m_Phone}
			</if> 
			<if test="m_Email != null and m_Email != ''">
				<if test="(m_Phone != null and m_Phone != '') or (m_Pw != null and m_Pw != '') ">
					, 
				</if>
				m_email = #{m_Email} 
			</if>  
		where m_id = #{m_Id}
	</update>
	
	<!-- 회원탈퇴 -->
	<delete id="memberUpdateLeave" parameterType="String">
		update member_tbl
		set m_availabled = '0'
		where m_id = #{m_Id} 
	</delete>	 	 
</mapper>
